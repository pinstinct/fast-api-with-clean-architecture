## 데이터베이스 설정

```shell
docker exec -it <container-id> bash
mysql -u root -h 127.0.0.1 -p
mysql> SHOW DATABASES;
mysql> CREATE SCHEMA `fastapi-ca;
```

## 앱 실행

```shell
python main.py
```

## Alembic

```shell
# 리비전 파일 자동 생성 
# -m 옵션: 메시지 작성
alembic revision --autogenerate -m "add User Table"

# 수행 (revision 파일의 upgrade 함수 실행)
# head 옵션: 가장 최신의 리비전 파일 수행 
alembic upgrade head

# 취소
alembic downgrade head
```


## 프로젝트 구조

### 아키텍처

- 관심사 분리와 계층형 아키텍처: 소프트웨어의 구성 요소들을 관심사에 따라 분리한다. 이는 네 개의 계층으로 나뉘어져 있다.
- 인터페이스 우선: 구성 요소들의 인터페이스를 먼저 정의해 사용한다. 세부 구현은 필요한 시점에 한다.
- 의존성 규칙: 클린 아키텍처의 핵심 원칙이다. 이 규칙에 따르면 소스 코드 의존성은 항상 외부에서 내부로 향해야 하며, 가장 중요한 코드(비즈니스 규칙)는 시스템의 중심에 있어야 한다.

#### 주요 4계층

(안)

- 엔티티 -> 도메인
- 유스 케이스 -> 애플리케이션
- 인터페이스 어댑터(컨트롤러, 게이트웨이, 프레젠터) -> 인터페이스
- 프레임워크 및 드라이버(장치, DB, 웹, UI, 외부 인터페이스) -> 인프라

(밖)

안으로 갈수록 고수준의 구성 요소가 된다. 고수준이란 더욱 추상화된 관점에서 문제를 해결하거나, 더 추상적이며 개념적인 관점을 의미한다.

##### 도메인(엔티티) 계층

- 도메인(domain): 애플리케이션이 해결하고자 하는 특정한 주제나 분야를 가리키며, 해당 분야에 적용되는 개념, 규칙, 데이터, 프로세스 등을 포함
- 저장소(repository): 외부 시스템인 데이터베이스에 저장하는 데이터 저장소를 기술하는 모듈
- 엔티티(entity): 비즈니스 도메인에서의 실제 개념이나 객체를 표현

##### 애플리케이션(유스 케이스) 계층

안쪽에서 두 번째 위치한다. 모든 소프트웨어 시스템은 그 애플리케이션이 해결하고자 하는 문제와 나름의 해결 방법을 가지고 있다. 이 계층에서는 그러한 특정 기능과 유스 케이스(use case)를 정의하고 구현한다.
따라서 로직이 가장 복잡하고 변경이 잦은 부분이다.

##### 인터페이스(인터페이스 어댑터) 계층

인터페이스 계층의 주요 특징

- 외부와 내부 사이의 데이터 변환
- 인터페이스 구현: 외부 시스템과의 통신을 담당한다.
- 외부 종속성의 분리

인터페이스 계층에는 컨트롤러, 게이트웨이, 프레젠터가 사용된다.

- 컨트롤러(controller): UI를 통해 전달된 사용자의 입력과 요청을 내부로 전달
- 게이트웨이(gateway): 외부 데이터 소스와의 통신을 담당 (외부 데이터베이스, API, 파일 시스템 등과의 상호작용 처리)
- 프레젠터(presenter): 내부 유스 케이스가 처리한 데이터를 전달받아 사용자가 볼 수 있는 형태로 가공해 UI로 전달

##### 인프라스트럭처(프레임워크 및 드라이버)

사용자 인터페이스, 디바이스, 웹 프레임워크, 데이터베이스 등과 같은 외부 환경과의 상호작용을 담당한다.

#### 의존관계 역전 원칙

각 계층의 구성 요소는 다른 계층의 구성 요소를 가져다 쓰게 된다. 즉, 의존성이 발생한다. 클린 아키텍처의 의존성 규칙은 그 의존성의 방향이 안으로 향하는 데에 있다.

### 의존성 주입

의존성 주입의 세 가지 유형

- 생성자 주입(constructor injection)
- 세터 주입(setter injection)
- 메서드 주입(method injection)

FastAPI는 엔드포인트 함수에 `Depends` 함수를 이용해 의존성을 주입할 수 있다. 그 외의 모듈에서 의존성을 주입하려면 의존성 프레임워크를 구현한 라이브러리를 활용해야 한다. 이 프로젝트에서는
`dependency-injector`를 이용했다.

### 기능

#### User 앱

- 회원 가입
- 로그인
- 유저 목록 조회
- 유저 정보 조회
- 유저 정보 수정
- 회원 탈퇴

#### Note 앱

- 노트 생성
- 노트 목록 조회
- 노트 정보 조회
- 노트 정보 수정
- 노트 삭제
- 태그 생성
- 태그 이름으로 노트 목록 조회

#### 미들웨어

- 유저 활동 로깅

#### 백그라운드 작업

- 환영 이메일 전송 

